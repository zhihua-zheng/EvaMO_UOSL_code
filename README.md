[![DOI](https://zenodo.org/badge/DOI/10.5281/zenodo.??.svg)](https://doi.org/10.5281/zenodo.??)

**This repository contains the MATLAB scripts used in the paper "Evaluating Monin-Obukhov scaling in unstable oceanic surface layer"**

You can reach me at [zhihua@uw.edu](mailto:zhihua@uw.edu) for questions related to the usage of this code. 

### Description
This set of scripts fufills three stages in generating the results presented in the paper:
- Load and process raw data
- Calculate key parameters
- Produce figures

### Prerequisites
This code is tested in MATLAB R2019b.

It also uses some external toolboxes/functions, as listed below:
- [Gibbs-SeaWater (GSW) Oceanographic Toolbox'](http://www.teos-10.org/software.htm)
- [Air-sea toolbox](https://github.com/sea-mat/air-sea)
- [cbrewer](https://www.mathworks.com/matlabcentral/fileexchange/34087-cbrewer-colorbrewer-schemes-for-matlab)
- [RGB](https://www.mathworks.com/matlabcentral/fileexchange/24497-rgb-triple-of-color-name-version-2) triple of color name

### Data
The data used in this work are mostly publicly available (see the "Data availability statement" in our paper). For your convience, a copy of the original data can be downloaded either from [this Google Drive link](https://drive.google.com/file/d/13UYYOT9AXFufjMw6_wr4-hoNv7M3tT7v/view?usp=sharing), or from the most recent [release]() of this repository.

### Work flow

### Reference

* McDougall, T.J. and P.M. Barker, 2011: Getting started with TEOS-10 and the Gibbs Seawater (GSW) Oceanographic Toolbox, 28pp., SCOR/IAPSO WG127, ISBN 978-0-646-55621-5.

* Charles, R. 2015: cbrewer : colorbrewer schemes for Matlab, MATLAB Central File Exchange. Retrieved May 26, 2019.

Functions for solving super-equilibirum model equations are in ./library
========================================================================

Figures are generated by script 'evaMO_main.m'.
Please adjust the paths to the related data on your machine.

...

Fig. 8: Kansas-Obs-Model phi comparison
  use data 'ocsp_pzData.mat' & 'spursi_pzData.mat'

...
